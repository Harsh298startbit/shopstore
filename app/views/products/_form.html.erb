<div class="container mt-4">
  <div class="card shadow-sm">
    <div class="card-body">

      <div class="mb-3">
        <%= f.label :name, class: "form-label" %>
        <%= f.text_field :name, class: "form-control", placeholder: "Product name" %>
      </div>

      <div class="mb-3">
        <%= f.label :description, class: "form-label" %>
        <%= f.text_area :description, class: "form-control", rows: 3, placeholder: "Product description" %>
      </div>

      <div class="mb-3">
        <%= f.label :collection_id, "Collection", class: "form-label" %>
        <%= f.collection_select :collection_id, Collection.all, :id, :name, 
            { prompt: "Select a collection" }, 
            { class: "form-control" } %>
      </div>

      

      <div class="mb-3">
        <%= f.label :rating, class: "form-label" %>
        <%= f.number_field :rating, step: 0.1, min: 0, max: 5, class: "form-control", placeholder: "Rating (0-5)" %>
      </div>

      <div class="mb-3">
        <%= f.label :discount_percentage, "Discount %", class: "form-label" %>
        <%= f.number_field :discount_percentage, step:1, min: 0, max: 100, class: "form-control", placeholder: "Discount percentage" %>
      </div>

      <div class="form-check mb-3">
        <%= f.check_box :featured, class: "form-check-input" %>
        <%= f.label :featured, class: "form-check-label" %>
      </div>

      <div class="mb-4">
        <%= f.label :image, class: "form-label" %>
        <%= f.file_field :image, class: "form-control", accept: "image/jpeg,image/jpg,image/png,image/webp,image/gif" %>
        <small class="text-muted">Allowed types: JPEG, PNG, WebP, GIF. Max size: 5MB</small>
        
        <!-- Image Preview -->
        <div id="image-preview" class="mt-3" style="display: none;">
          <img id="preview-img" src="" alt="Image preview" class="img-thumbnail" style="max-width: 200px; max-height: 200px; object-fit: cover;">
          <button type="button" id="remove-image" class="btn btn-sm btn-outline-danger mt-2">Remove Image</button>
        </div>
        
        <!-- Existing image preview for edit form -->
        <% if f.object.image.attached? %>
          <div id="existing-image" class="mt-3">
            <p class="mb-2"><strong>Current image:</strong></p>
            <%= cloudinary_thumbnail(f.object.image, alt: f.object.name, class: "img-thumbnail") %>
          </div>
        <% end %>
      </div>

      <hr>

      <h5 class="mb-3">Product Variants</h5>
      <p class="text-muted small">Add different variants like sizes, colors, or weights for this product.</p>

      <div id="variants-container" class="mb-3">
        <%= f.fields_for :product_variants do |variant_form| %>
          <%= render 'variant_fields', f: variant_form %>
        <% end %>
      </div>

      <div class="mb-4">
        <button type="button" id="add-variant-button" class="btn btn-outline-primary">
          <i class="ion-ios-add"></i> Add Another Variant
        </button>
      </div>

      <div class="d-flex justify-content-end">
        <%= f.submit "Save Product", class: "btn btn-primary" %>
      </div>

    </div>
  </div>
</div>
